(this["webpackJsonpsite-forum"]=this["webpackJsonpsite-forum"]||[]).push([[0],[,,,,,,function(e,t,r){},,function(e,t,r){},,,,,,function(e,t,r){},function(e,t,r){},function(e,t,r){},,,function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),s=r(9),c=r.n(s),i=(r(14),r(4)),o=(r(15),{}),d=a.a.createContext(o);var u,l=r(5);function p(e,t){switch(t.type){case u.test:return console.log("State API WORKIN"),e;case u.setThreads:return Object(l.a)(Object(l.a)({},e),{},{threads:t.payload});case u.setUsers:return Object(l.a)(Object(l.a)({},e),{},{users:t.payload});case u.setBanned:return Object(l.a)(Object(l.a)({},e),{},{blocks:t.payload});case u.setPassword:return Object(l.a)(Object(l.a)({},e),{},{password:t.payload});case u.setCurrentScreen:return Object(l.a)(Object(l.a)({},e),{},{screen:t.payload});default:return console.log("Action not defined in the reducer"),e}}function h(e){return{type:u.setThreads,payload:e}}function j(e){return{type:u.setUsers,payload:e}}function b(e){return{type:u.setBanned,payload:e}}function f(e){return{type:u.setPassword,payload:e}}function x(e){return{type:u.setCurrentScreen,payload:e}}!function(e){e[e.test=0]="test",e[e.setPassword=1]="setPassword",e[e.setThreads=2]="setThreads",e[e.setUsers=3]="setUsers",e[e.setBanned=4]="setBanned",e[e.setCurrentScreen=5]="setCurrentScreen"}(u||(u={}));r(16);var v=r(0);function O(){var e=a.a.useContext(d),t=e.state,r=e.dispatch;function n(e,t){e.stopPropagation(),r(x(t))}function s(e){if(t.screen===e)return"active-nav"}return Object(v.jsxs)("div",{children:[Object(v.jsx)("header",{children:Object(v.jsx)("h1",{children:" Forum Moderator "})}),"login"!==t.screen&&Object(v.jsx)("nav",{children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("span",{children:"["}),Object(v.jsx)("li",{onClick:function(e){return n(e,"dashboard")},className:s("dashboard"),children:"Dashboard"}),Object(v.jsx)("span",{children:"/"}),Object(v.jsx)("li",{onClick:function(e){return n(e,"threads")},className:s("threads"),children:"Threads"}),Object(v.jsx)("span",{children:"/"}),Object(v.jsx)("li",{onClick:function(e){return n(e,"users")},className:s("users"),children:"Users"}),Object(v.jsx)("span",{children:"]"})]})})]})}var m=r(2),w=r.n(m),g=r(3),y=(r(19),"https://galavtg.herokuapp.com/api/"),k={adminlogin:"".concat(y,"thread/admin/login/"),reply:"".concat(y,"thread/admin/reply"),deleteAthred:"".concat(y,"thread/admin/removeThread"),deleteAcomment:"".concat(y,"thread/deletereply"),banuser:"".concat(y,"admin/banUser"),getallthreads:"".concat(y,"thread/admin/getAllThread"),getallusers:"".concat(y,"admin/getalluser"),getallbanned:"".concat(y,"admin/getAllBannedUser")};function C(){var e=a.a.useContext(d).dispatch,t=a.a.useState({username:"",password:""}),r=Object(i.a)(t,2),n=r[0],s=r[1];function c(){return(c=Object(g.a)(w.a.mark((function t(r){var a,s;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),!(n.username.length<=1||n.password.length<=1)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,fetch(k.adminlogin,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n.username,password:n.password})});case 5:return a=t.sent,t.next=8,a.json();case 8:(s=t.sent).err?alert("Error: "+s.err):(window.localStorage.setItem("usertoken",s._token),e(f(s._token)),e(x("dashboard")));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(v.jsxs)("div",{id:"form",children:[Object(v.jsx)("h2",{children:"Log In"}),Object(v.jsx)("label",{children:"Username"}),Object(v.jsx)("input",{type:"text",placeholder:"username",onChange:function(e){return s(Object(l.a)(Object(l.a)({},n),{},{username:e.target.value}))}}),Object(v.jsx)("label",{children:"password"}),Object(v.jsx)("input",{type:"password",placeholder:"password",onChange:function(e){return s(Object(l.a)(Object(l.a)({},n),{},{password:e.target.value}))}}),Object(v.jsx)("input",{className:"submit",type:"submit",value:"Login",onClick:function(e){return function(e){return c.apply(this,arguments)}(e)}})]})}r(6);function N(e){var t=Date.now()-e;if(t<=354e4){var r=Math.round(t/6e4);return r<=1?r+" min ago":r+" mins ago"}if(t<=828e5){var n=Math.round(t/36e5);return n<=1?n+" hour ago":n+" hours ago"}var a=Math.round(t/864e5);return 1===a?a+" day ago":a>=30?"long time ago":a+" days ago"}var S=r.p+"static/media/male1.dece8157.png",T=r.p+"static/media/male2.0fb790b9.png",P=r.p+"static/media/male3.448007ee.png",B=r.p+"static/media/male4.730de75b.png",E=r.p+"static/media/female1.85a02bd8.png",U=r.p+"static/media/female2.71b2d9ae.png",_=r.p+"static/media/female3.c5486fee.png",J=r.p+"static/media/female4.4b6a858f.png",D=[S,T,P,B,E,U,_,J];function A(e){return Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:"thread-heading",children:[Object(v.jsx)("img",{src:D[e.creator.avatar],width:"50",height:"50",alt:"avatar icon"}),Object(v.jsxs)("div",{className:"creatorContainer",children:[Object(v.jsxs)("div",{className:"creator",children:[Object(v.jsx)("div",{className:"creator-name",children:e.creator.username}),Object(v.jsxs)("div",{className:"thread-date",children:[" ",N(e.thread.date)," "]})]}),Object(v.jsx)("div",{className:"thread-title",children:e.thread.title})]})]}),Object(v.jsx)("div",{className:"thread-description",children:e.thread.text})]})}r(8);var F=r.p+"static/media/gala.7bfe8315.png";function I(e){return L.apply(this,arguments)}function L(){return(L=Object(g.a)(w.a.mark((function e(t){var r,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return",{err:"password was not defined"});case 2:return e.next=4,fetch(k.getallthreads,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t})});case 4:return r=e.sent,e.next=7,r.json();case 7:if(n=e.sent){e.next=10;break}throw new Error;case 10:if(!n.err){e.next=12;break}throw new Error(n.err);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=[S,T,P,B,E,U,_,J];function R(e){var t=a.a.useContext(d),r=t.state,n=t.dispatch,s=a.a.useState(""),c=Object(i.a)(s,2),o=c[0],u=c[1],l=a.a.useState(!1),p=Object(i.a)(l,2),j=p[0],b=p[1];if(void 0===e.replies)return Object(v.jsx)("div",{children:"empty"});var f=function(){var t=Object(g.a)(w.a.mark((function t(a,s,c){var i,o,d;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.stopPropagation(),window.confirm("Delete the reply?")){t.next=3;break}return t.abrupt("return");case 3:return b(!0),t.prev=4,t.next=7,fetch(k.deleteAcomment,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_token:c,threadid:e.threadid,commentid:s})});case 7:return i=t.sent,t.next=10,i.json();case 10:if(!(o=t.sent).err){t.next=13;break}throw new Error(o.err);case 13:return t.next=15,I(r.password);case 15:d=t.sent,n(h(d)),b(!1),t.next=24;break;case 20:t.prev=20,t.t0=t.catch(4),alert("Cannot delete a reply\n"+t.t0),b(!1);case 24:case"end":return t.stop()}}),t,null,[[4,20]])})));return function(e,r,n){return t.apply(this,arguments)}}(),x=function(){var e=Object(g.a)(w.a.mark((function e(t,n){var a,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),t.preventDefault(),window.confirm("Ban or Unban the user?")){e.next=4;break}return e.abrupt("return");case 4:return b(!0),e.prev=5,e.next=8,fetch(k.banuser,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:r.password,_id:n})});case 8:return a=e.sent,e.next=11,a.json();case 11:(s=e.sent).message?alert(s.message):alert("The user was banned"),b(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),alert("Cant ban a user.\n"+e.t0),b(!1);case 20:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(t,r){return e.apply(this,arguments)}}(),O=function(){var t=Object(g.a)(w.a.mark((function t(a){var s,c,i;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),a.stopPropagation(),b(!0),t.prev=3,t.next=6,fetch(k.reply,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:r.password,threadid:e.threadid,text:o})});case 6:return s=t.sent,t.next=9,s.json();case 9:return(c=t.sent).err&&alert("Cant make reply. "+c.err),u(""),t.next=14,I(r.password);case 14:i=t.sent,n(h(i)),b(!1),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(3),alert("Cant ban a user.\n"+t.t0),b(!1);case 23:case"end":return t.stop()}}),t,null,[[3,19]])})));return function(e){return t.apply(this,arguments)}}();return Object(v.jsxs)("div",{children:[e.replies.map((function(e,t){return Object(v.jsxs)("div",{id:"replies-container",children:[Object(v.jsxs)("div",{className:"thread-heading",children:[e.isAdmin?Object(v.jsx)("img",{src:F,width:"50",height:"50",alt:"avatar icon"}):Object(v.jsx)("img",{src:M[e.avatar],width:"50",height:"50",alt:"avatar icon"}),Object(v.jsxs)("div",{className:"creatorContainer",children:[Object(v.jsxs)("div",{className:"creator",children:[Object(v.jsx)("div",{className:"creator-name",children:e.username}),Object(v.jsxs)("div",{className:"thread-date",children:[" ",N(e.time)," "]})]}),Object(v.jsx)("div",{className:"thread-description",children:e.text})]})]}),Object(v.jsxs)("div",{className:"thread-options-container",children:[Object(v.jsx)("div",{onClick:function(t){return!j&&f(t,e._id,e._token)},children:"Delete"}),Object(v.jsx)("div",{onClick:function(t){return!j&&x(t,e.userid)},children:"Block"})]})]},t)})),Object(v.jsxs)("div",{id:"text-reply",children:[Object(v.jsx)("input",{placeholder:"Reply",value:o,onChange:function(e){return u(e.target.value)}}),Object(v.jsx)("button",{onClick:function(e){return!j&&O(e)},children:" Send "})]})]})}function W(){var e=a.a.useContext(d),t=e.state,r=(e.dispatch,a.a.useState(null)),n=Object(i.a)(r,2),s=n[0];n[1];return a.a.useEffect((function(){return function(){return clearTimeout(s)}}),[]),Object(v.jsx)("div",{style:{marginBottom:"6rem"},children:t.threads?t.threads.map((function(e,t){return Object(v.jsx)("div",{children:Object(v.jsx)(H,{athread:e})},t)})):Object(v.jsx)("div",{className:"loading",children:" ... Loading threads or threads are just empty ... "})})}function H(e){var t=e.athread,r=a.a.useContext(d),n=r.state,s=r.dispatch,c=a.a.useState(!1),o=Object(i.a)(c,2),u=o[0],l=o[1],p=a.a.useState(!1),j=Object(i.a)(p,2),b=j[0],f=j[1],x=function(e){e.stopPropagation(),l(!u)},O=function(){var e=Object(g.a)(w.a.mark((function e(r){var a,c,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Delete the thread?")){e.next=2;break}return e.abrupt("return");case 2:return r.stopPropagation(),f(!0),e.prev=4,a=fetch(k.deleteAthred,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:n.password,threadid:t._id})}),e.next=8,a;case 8:return e.next=10,e.sent.json();case 10:if(!(c=e.sent).err){e.next=13;break}throw new Error(c.err);case 13:return e.next=15,I(n.password);case 15:i=e.sent,s(h(i)),f(!1),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),alert("Cant delete.\n"+e.t0);case 23:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(g.a)(w.a.mark((function e(r){var a,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Ban or Unban the user?")){e.next=2;break}return e.abrupt("return");case 2:return r.stopPropagation(),f(!0),e.prev=4,e.next=7,fetch(k.banuser,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:n.password,_id:t.creator.uid})});case 7:return a=e.sent,e.next=10,a.json();case 10:if(!(s=e.sent).message){e.next=15;break}alert("The user was unbannded!"),e.next=20;break;case 15:if(!s.err){e.next=19;break}throw new Error(s.err);case 19:alert("The user was banned");case 20:f(!1),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(4),alert("Cant ban a user.\n"+e.t0);case 26:case"end":return e.stop()}}),e,null,[[4,23]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"threaditem",children:[Object(v.jsx)(A,{creator:t.creator,thread:t.thread}),Object(v.jsxs)("div",{className:"thread-options-container",children:[Object(v.jsx)("div",{onClick:function(e){return!b&&O(e)},children:"Delete"}),u?Object(v.jsx)("div",{onClick:x,children:">>Close<<"}):Object(v.jsx)("div",{onClick:x,children:"Open"}),Object(v.jsx)("div",{onClick:function(e){return!b&&m(e)},children:"Block"})]}),u&&Object(v.jsx)(R,{replies:t.replies,threadid:t._id})]})}r(20);function K(e){return q.apply(this,arguments)}function q(){return(q=Object(g.a)(w.a.mark((function e(t){var r,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return",{err:"password was not defined"});case 2:return e.next=4,fetch(k.getallusers,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t})});case 4:return r=e.sent,e.next=7,r.json();case 7:if(n=e.sent){e.next=10;break}throw new Error;case 10:if(!n.err){e.next=12;break}throw new Error(n.err);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){return G.apply(this,arguments)}function G(){return(G=Object(g.a)(w.a.mark((function e(t){var r,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return",{err:"password was not defined"});case 2:return e.next=4,fetch(k.getallbanned,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t})});case 4:return r=e.sent,e.next=7,r.json();case 7:if(n=e.sent){e.next=10;break}throw new Error;case 10:if(!n.err){e.next=12;break}throw new Error(n.err);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(){var e=a.a.useContext(d),t=e.state,r=e.dispatch,n=a.a.useState(0),s=Object(i.a)(n,2),c=s[0],o=s[1],u=a.a.useState({}),l=Object(i.a)(u,2),p=l[0],f=l[1];return a.a.useEffect((function(){var e=function(){var n=Object(g.a)(w.a.mark((function n(){var a,s,c,i;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I(t.password);case 3:return a=n.sent,n.next=6,K(t.password);case 6:return s=n.sent,n.next=9,z(t.password);case 9:c=n.sent,r(h(a)),r(j(s)),r(b(c)),i=0,a.forEach((function(e){e.replies&&(i+=e.replies.length)})),o(i),null===p&&f(setInterval((function(){return e()}),1e4)),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(0),alert("Failed to load from the server. "+n.t0);case 22:case"end":return n.stop()}}),n,null,[[0,19]])})));return function(){return n.apply(this,arguments)}}();return e(),function(){return clearTimeout(p)}}),[]),Object(v.jsxs)("div",{id:"dashboard",children:[Object(v.jsx)("h3",{children:"Server Statistics"}),Object(v.jsxs)("div",{className:"statistics",children:[Object(v.jsx)("div",{children:"Threads count: "}),Object(v.jsx)("div",{children:t.threads&&t.threads.length}),Object(v.jsx)("div",{children:"Total replies: "})," ",Object(v.jsx)("div",{children:c}),Object(v.jsx)("div",{children:"Users count:"}),Object(v.jsx)("div",{children:t.users&&t.users.length}),Object(v.jsx)("div",{children:"Blocked users count:"}),Object(v.jsx)("div",{children:t.blocks&&t.blocks.length})]})]})}r(21);var V=[S,T,P,B,E,U,_,J];function X(){var e=a.a.useContext(d),t=e.state,r=e.dispatch,n=a.a.useState(!1),s=Object(i.a)(n,2),c=s[0],o=s[1],u=function(){var e=Object(g.a)(w.a.mark((function e(n,a){var s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stopPropagation(),n.preventDefault(),window.confirm("Ban or Unban the user?")){e.next=4;break}return e.abrupt("return");case 4:return o(!0),e.prev=5,e.next=8,fetch(k.banuser,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t.password,_id:a})});case 8:return e.next=10,z(t.password);case 10:s=e.sent,r(b(s)),o(!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),alert("Cant ban a user.\n"+e.t0),o(!1);case 19:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,r){return e.apply(this,arguments)}}();function l(e){var r=!1;if(t.blocks)for(var n=0;n<t.blocks.length;n++)e._id===t.blocks[n].userid&&(r=!0);return r?Object(v.jsx)("div",{onClick:function(t){return!c&&u(t,e._id)},children:"Unblock"}):Object(v.jsx)("div",{onClick:function(t){return!c&&u(t,e._id)},children:"Block"})}return Object(v.jsx)(a.a.Fragment,{children:t.users&&t.users.map((function(e,t){return Object(v.jsx)("div",{id:"user-container",children:Object(v.jsxs)("div",{className:"heading",children:[Object(v.jsx)("img",{src:V[e.avatar],width:"50",height:"50",alt:"avatar icon"}),Object(v.jsxs)("div",{className:"creatorContainer",children:[Object(v.jsxs)("div",{className:"creator",children:[Object(v.jsx)("div",{className:"creator-name",children:e.username}),Object(v.jsxs)("div",{className:"thread-date",children:["Last reply: ",N(e.lastreply)," "]})]}),Object(v.jsx)("div",{className:"thread-description",children:e.description}),Object(v.jsx)("div",{className:"user-options-container",children:l(e)})]})]})},t)}))})}var Y=function(){var e=a.a.useReducer(p,{text:"Hello there",password:"none",screen:"loading"}),t=Object(i.a)(e,2),r=t[0],n=t[1];return a.a.useEffect((function(){n(x("login"))}),[]),Object(v.jsxs)(d.Provider,{value:{state:r,dispatch:n},children:[Object(v.jsx)(O,{}),function(){switch(r.screen){case"loading":return Object(v.jsx)("div",{children:"Wait loading"});case"login":return Object(v.jsx)(C,{});case"threads":return Object(v.jsx)(W,{});case"users":return Object(v.jsx)(X,{});default:return Object(v.jsx)(Q,{})}}()]})},Z=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,23)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),s(e),c(e)}))};c.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(Y,{})}),document.getElementById("root")),Z()}],[[22,1,2]]]);
//# sourceMappingURL=main.a44bc95d.chunk.js.map